{"ast":null,"code":"import _asyncToGenerator from \"/Users/mac/Documents/2PAI_MIGRATION_PROJECT/ogrand_marche_admin/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { DatePipe } from '@angular/common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"src/app/services/users/user-service.service\";\nimport * as i3 from \"../../_metronic/partials/content/widgets/_new/cards/cards-widget20/cards-widget20.component\";\nimport * as i4 from \"../../_metronic/partials/content/widgets/_new/cards/cards-widget17/cards-widget17.component\";\nconst _c0 = [\"modal\"];\n\nfunction DashboardComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 1)(1, \"div\", 2);\n    i0.ɵɵelement(2, \"app-cards-widget17\", 3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 2);\n    i0.ɵɵelement(4, \"app-cards-widget20\", 4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 2);\n    i0.ɵɵelement(6, \"app-cards-widget20\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 2);\n    i0.ɵɵelement(8, \"app-cards-widget20\", 6);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"AmoutGlobalTransaction\", ctx_r0.AmoutGlobal)(\"rembourser\", ctx_r0.ttrembourser)(\"NoNrembourser\", ctx_r0.ttNonrembourser);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"width\", ctx_r0.pourcentRechargements);\n    i0.ɵɵpropertyInterpolate(\"percent\", ctx_r0.pourcentRechargements);\n    i0.ɵɵpropertyInterpolate(\"nbrElement\", ctx_r0.TotalRechargements);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"width\", ctx_r0.pourcentAchatcarte);\n    i0.ɵɵpropertyInterpolate(\"percent\", ctx_r0.pourcentAchatcarte);\n    i0.ɵɵpropertyInterpolate(\"nbrElement\", ctx_r0.TotalAchatcarte);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"width\", ctx_r0.pourcenttransaction);\n    i0.ɵɵpropertyInterpolate(\"percent\", ctx_r0.pourcenttransaction);\n    i0.ɵɵpropertyInterpolate(\"nbrElement\", ctx_r0.Totaltransaction);\n  }\n}\n\nfunction DashboardComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 1)(1, \"div\", 2);\n    i0.ɵɵelement(2, \"app-cards-widget20\", 7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 2);\n    i0.ɵɵelement(4, \"app-cards-widget20\", 8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 2);\n    i0.ɵɵelement(6, \"app-cards-widget20\", 9);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"width\", ctx_r1.pourcentCourse);\n    i0.ɵɵpropertyInterpolate(\"percent\", ctx_r1.pourcentCourse);\n    i0.ɵɵpropertyInterpolate(\"nbrElement\", ctx_r1.TotalCourse);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"width\", ctx_r1.pourcentCourseTerminer);\n    i0.ɵɵpropertyInterpolate(\"percent\", ctx_r1.pourcentCourseTerminer);\n    i0.ɵɵpropertyInterpolate(\"nbrElement\", ctx_r1.TotalCousreterminer);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"width\", ctx_r1.pourcenCourseEncours);\n    i0.ɵɵpropertyInterpolate(\"percent\", ctx_r1.pourcenCourseEncours);\n    i0.ɵɵpropertyInterpolate(\"nbrElement\", ctx_r1.TotalCourseEcours);\n  }\n}\n\nexport let DashboardComponent = /*#__PURE__*/(() => {\n  class DashboardComponent {\n    constructor(datePipe, userService, changeDetector) {\n      this.datePipe = datePipe;\n      this.userService = userService;\n      this.changeDetector = changeDetector;\n      this.modalConfig = {\n        modalTitle: 'Modal title',\n        dismissButtonLabel: 'Submit',\n        closeButtonLabel: 'Cancel'\n      };\n      this.Distributeur = [];\n      this.Rechargement = [];\n      this.Course = [];\n      this.Achatcarte = [];\n      this.CourseTerminer = [];\n      this.AmoutGlobal = 0;\n      this.AmoutGlobalCourse = 0;\n      this.ttrembourser = 0;\n      this.ttterminer = 0;\n      this.ttNonrembourser = 0;\n      this.transactionList = [];\n      this.CousreEncourList = []; // GetUser(){\n      //   this.UserConnected =  this.userService.UserConnected();\n      //   this.GeTalldistributeur();\n      //   console.log(this.UserConnected)\n      // }\n\n      this.UserList = [];\n    }\n\n    openModal() {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        return yield _this.modalComponent.open();\n      })();\n    }\n\n    ngOnInit() {\n      //this.GetAllUsers()\n      this.UserConnected = this.userService.GetUserData();\n      this.UserConnected = JSON.parse(this.UserConnected); //console.log(\"user =>\",this.UserConnected);\n\n      this.GetAllCommand();\n      this.GetAllCourse();\n    }\n\n    GetAllCommand() {\n      this.userService.getAllCommandeProduit().subscribe(com => {\n        // console.log(com.data);\n        for (var data of com.data) {\n          var localprice = parseInt(data.prixunitaire) * parseInt(data.quantite);\n\n          if (data.Idvendeur == this.UserConnected.data.id.toString()) {\n            this.Rechargement.push(data);\n            this.AmoutGlobal += localprice;\n\n            if (data.state == \"Livré\") {\n              this.ttrembourser += localprice;\n              this.Achatcarte.push(data);\n            } else {\n              this.ttNonrembourser += localprice;\n              this.transactionList.push(data);\n            }\n          } else {\n            if (this.UserConnected.data.role == \"admin\") {\n              this.Rechargement.push(data);\n              this.AmoutGlobal += localprice;\n\n              if (data.state == \"Livré\") {\n                this.ttrembourser += localprice;\n                this.Achatcarte.push(data);\n              } else {\n                this.ttNonrembourser += localprice;\n                this.transactionList.push(data);\n              }\n            }\n          }\n        }\n\n        this.TotalAchatcarte = this.Achatcarte.length;\n        this.pourcentAchatcarte = this.TotalAchatcarte * 100 / 10000;\n        this.Totaltransaction = this.transactionList.length;\n        this.pourcenttransaction = this.Totaltransaction * 100 / 10000;\n        this.TotalRechargements = this.Rechargement.length;\n        this.pourcentRechargements = this.TotalRechargements * 100 / 10000;\n        this.changeDetector.detectChanges();\n      });\n    }\n\n    GetAllCourse() {\n      this.userService.GetAllCourse().subscribe(com => {\n        console.log(\"ddddd\", com.data);\n\n        for (var data of com.data) {\n          // var localprice = parseInt(data.prixunitaire)*parseInt(data.quantite);\n          if (data.transporteuridentifiant == this.UserConnected.data.id.toString()) {\n            this.Course.push(data);\n\n            if (data.statut == \"terminer\" || data.statut == \"arriver\") {\n              //this.ttrembourser += parseInt(data.montant);\n              this.CourseTerminer.push(data);\n            } else {\n              //this.ttNonrembourser += localprice;\n              this.CousreEncourList.push(data);\n            }\n          } else {\n            if (this.UserConnected.data.role == \"admin\") {\n              this.Course.push(data);\n\n              if (data.statut == \"terminer\" || data.statut == \"arriver\") {\n                //this.ttrembourser += parseInt(data.montant);\n                this.CourseTerminer.push(data);\n              } else {\n                //this.ttNonrembourser += localprice;\n                this.CousreEncourList.push(data);\n              }\n            }\n          }\n        }\n\n        this.TotalCousreterminer = this.CourseTerminer.length;\n        console.log(this.TotalCousreterminer);\n        this.pourcentCourseTerminer = this.TotalCousreterminer * 100 / 10000;\n        this.TotalCourseEcours = this.CousreEncourList.length;\n        this.pourcenCourseEncours = this.TotalCourseEcours * 100 / 10000;\n        this.TotalCourse = this.Course.length;\n        this.pourcentCourse = this.TotalCourse * 100 / 10000;\n        this.changeDetector.detectChanges();\n      });\n    }\n\n  }\n\n  DashboardComponent.ɵfac = function DashboardComponent_Factory(t) {\n    return new (t || DashboardComponent)(i0.ɵɵdirectiveInject(i1.DatePipe), i0.ɵɵdirectiveInject(i2.UserServiceService), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef));\n  };\n\n  DashboardComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: DashboardComponent,\n    selectors: [[\"app-dashboard\"]],\n    viewQuery: function DashboardComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.modalComponent = _t.first);\n      }\n    },\n    features: [i0.ɵɵProvidersFeature([DatePipe])],\n    decls: 2,\n    vars: 2,\n    consts: [[\"class\", \"row g-5 g-xl-10 mb-15s mb-xl-2\", 4, \"ngIf\"], [1, \"row\", \"g-5\", \"g-xl-10\", \"mb-15s\", \"mb-xl-2\"], [1, \"col-md-6\", \"col-lg-6\", \"col-xl-6\", \"col-xxl-3\", \"mb-md-5\", \"mb-xl-10\"], [\"cssClass\", \"h-md-50 mb-5 mb-xl-10\", 3, \"AmoutGlobalTransaction\", \"rembourser\", \"NoNrembourser\"], [\"cssClass\", \"h-md-50 mb-5 mb-xl-10w\", \"description\", \"Commandes totales\", \"color\", \"#F1416C\", \"img\", \"./assets/media/patterns/vector-1.png\", 3, \"width\", \"percent\", \"nbrElement\"], [\"cssClass\", \"h-md-50 mb-5 mb-xl-10\", \"description\", \"Commandes termin\\u00E9es\", \"color\", \"#5e6278\", \"img\", \"./assets/media/patterns/vector-2.png\", 3, \"width\", \"percent\", \"nbrElement\"], [\"cssClass\", \"h-md-50 mb-5 mb-xl-10\", \"description\", \"Commande en cours\", \"color\", \"#1E2B77\", \"img\", \"./assets/media/patterns/vector-2.png\", 3, \"width\", \"percent\", \"nbrElement\"], [\"cssClass\", \"h-md-50 mb-5 mb-xl-10w\", \"description\", \"Courses totales\", \"color\", \"#F1416C\", \"img\", \"./assets/media/patterns/vector-1.png\", 3, \"width\", \"percent\", \"nbrElement\"], [\"cssClass\", \"h-md-50 mb-5 mb-xl-10\", \"description\", \"Courses termin\\u00E9es\", \"color\", \"#5e6278\", \"img\", \"./assets/media/patterns/vector-2.png\", 3, \"width\", \"percent\", \"nbrElement\"], [\"cssClass\", \"h-md-50 mb-5 mb-xl-10\", \"description\", \"Courses en cours\", \"color\", \"#1E2B77\", \"img\", \"./assets/media/patterns/vector-2.png\", 3, \"width\", \"percent\", \"nbrElement\"]],\n    template: function DashboardComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, DashboardComponent_div_0_Template, 9, 12, \"div\", 0);\n        i0.ɵɵtemplate(1, DashboardComponent_div_1_Template, 7, 9, \"div\", 0);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.UserConnected.data.role == \"admin\" || ctx.UserConnected.data.role == \"Producteur\" || ctx.UserConnected.data.role == \"fournisseur\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.UserConnected.data.role == \"admin\" || ctx.UserConnected.data.role == \"Transporteur\");\n      }\n    },\n    dependencies: [i1.NgIf, i3.CardsWidget20Component, i4.CardsWidget17Component],\n    styles: [\"[_nghost-%COMP%]{width:100%}.h-100[_ngcontent-%COMP%]{height:100%}\"]\n  });\n  return DashboardComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}