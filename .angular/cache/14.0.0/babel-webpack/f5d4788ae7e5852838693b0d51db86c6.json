{"ast":null,"code":"import _asyncToGenerator from \"/Users/mac/Documents/2PAI_MIGRATION_PROJECT/ogrand_marche_admin/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { DatePipe } from '@angular/common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"src/app/services/users/user-service.service\";\nimport * as i3 from \"../../_metronic/partials/content/widgets/_new/cards/cards-widget20/cards-widget20.component\";\nimport * as i4 from \"../../_metronic/partials/content/widgets/_new/cards/cards-widget17/cards-widget17.component\";\nconst _c0 = [\"modal\"];\n\nfunction DashboardComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 1)(1, \"div\", 2);\n    i0.ɵɵelement(2, \"app-cards-widget17\", 3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 2);\n    i0.ɵɵelement(4, \"app-cards-widget20\", 4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 2);\n    i0.ɵɵelement(6, \"app-cards-widget20\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 2);\n    i0.ɵɵelement(8, \"app-cards-widget20\", 6);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"AmoutGlobalTransaction\", ctx_r0.AmoutGlobal)(\"rembourser\", ctx_r0.ttrembourser)(\"NoNrembourser\", ctx_r0.ttNonrembourser);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"width\", ctx_r0.pourcentRechargements);\n    i0.ɵɵpropertyInterpolate(\"percent\", ctx_r0.pourcentRechargements);\n    i0.ɵɵpropertyInterpolate(\"nbrElement\", ctx_r0.TotalRechargements);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"width\", ctx_r0.pourcentAchatcarte);\n    i0.ɵɵpropertyInterpolate(\"percent\", ctx_r0.pourcentAchatcarte);\n    i0.ɵɵpropertyInterpolate(\"nbrElement\", ctx_r0.TotalAchatcarte);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"width\", ctx_r0.pourcenttransaction);\n    i0.ɵɵpropertyInterpolate(\"percent\", ctx_r0.pourcenttransaction);\n    i0.ɵɵpropertyInterpolate(\"nbrElement\", ctx_r0.Totaltransaction);\n  }\n}\n\nfunction DashboardComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 1)(1, \"div\", 2);\n    i0.ɵɵelement(2, \"app-cards-widget20\", 7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 2);\n    i0.ɵɵelement(4, \"app-cards-widget20\", 8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 2);\n    i0.ɵɵelement(6, \"app-cards-widget20\", 9);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"width\", ctx_r1.pourcentCourse);\n    i0.ɵɵpropertyInterpolate(\"percent\", ctx_r1.pourcentCourse);\n    i0.ɵɵpropertyInterpolate(\"nbrElement\", ctx_r1.TotalCourse);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"width\", ctx_r1.pourcentCourseTerminer);\n    i0.ɵɵpropertyInterpolate(\"percent\", ctx_r1.pourcentCourseTerminer);\n    i0.ɵɵpropertyInterpolate(\"nbrElement\", ctx_r1.TotalCousreterminer);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"width\", ctx_r1.pourcenCourseEncours);\n    i0.ɵɵpropertyInterpolate(\"percent\", ctx_r1.pourcenCourseEncours);\n    i0.ɵɵpropertyInterpolate(\"nbrElement\", ctx_r1.TotalCourseEcours);\n  }\n}\n\nexport class DashboardComponent {\n  constructor(datePipe, userService, changeDetector) {\n    this.datePipe = datePipe;\n    this.userService = userService;\n    this.changeDetector = changeDetector;\n    this.modalConfig = {\n      modalTitle: 'Modal title',\n      dismissButtonLabel: 'Submit',\n      closeButtonLabel: 'Cancel'\n    };\n    this.Distributeur = [];\n    this.Rechargement = [];\n    this.Course = [];\n    this.Achatcarte = [];\n    this.CourseTerminer = [];\n    this.AmoutGlobal = 0;\n    this.AmoutGlobalCourse = 0;\n    this.ttrembourser = 0;\n    this.ttterminer = 0;\n    this.ttNonrembourser = 0;\n    this.transactionList = [];\n    this.CousreEncourList = []; // GetUser(){\n    //   this.UserConnected =  this.userService.UserConnected();\n    //   this.GeTalldistributeur();\n    //   console.log(this.UserConnected)\n    // }\n\n    this.UserList = [];\n  }\n\n  openModal() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      return yield _this.modalComponent.open();\n    })();\n  }\n\n  ngOnInit() {\n    //this.GetAllUsers()\n    this.UserConnected = this.userService.GetUserData();\n    this.UserConnected = JSON.parse(this.UserConnected);\n    console.log(\"user =>\", this.UserConnected);\n    this.GetAllCommand();\n    this.GetAllCourse();\n  }\n\n  GetAllCommand() {\n    this.userService.getAllCommandeProduit().subscribe(com => {\n      // console.log(com.data);\n      for (var data of com.data) {\n        var localprice = parseInt(data.prixunitaire) * parseInt(data.quantite);\n\n        if (data.Idvendeur == this.UserConnected.data.id.toString()) {\n          this.Rechargement.push(data);\n          this.AmoutGlobal += localprice;\n\n          if (data.state == \"Livré\") {\n            this.ttrembourser += localprice;\n            this.Achatcarte.push(data);\n          } else {\n            this.ttNonrembourser += localprice;\n            this.transactionList.push(data);\n          }\n        } else {\n          if (this.UserConnected.data.role == \"admin\") {\n            this.Rechargement.push(data);\n            this.AmoutGlobal += localprice;\n\n            if (data.state == \"Livré\") {\n              this.ttrembourser += localprice;\n              this.Achatcarte.push(data);\n            } else {\n              this.ttNonrembourser += localprice;\n              this.transactionList.push(data);\n            }\n          }\n        }\n      }\n\n      this.TotalAchatcarte = this.Achatcarte.length;\n      this.pourcentAchatcarte = this.TotalAchatcarte * 100 / 10000;\n      this.Totaltransaction = this.transactionList.length;\n      this.pourcenttransaction = this.Totaltransaction * 100 / 10000;\n      this.TotalRechargements = this.Rechargement.length;\n      this.pourcentRechargements = this.TotalRechargements * 100 / 10000;\n      this.changeDetector.detectChanges();\n    });\n  }\n\n  GetAllCourse() {\n    this.userService.GetAllCourse().subscribe(com => {\n      console.log(\"ddddd\", com.data);\n\n      for (var data of com.data) {\n        // var localprice = parseInt(data.prixunitaire)*parseInt(data.quantite);\n        if (data.transporteuridentifiant == this.UserConnected.data.id.toString()) {\n          this.Course.push(data);\n\n          if (data.statut == \"terminer\" || data.statut == \"arriver\") {\n            //this.ttrembourser += parseInt(data.montant);\n            this.CourseTerminer.push(data);\n          } else {\n            //this.ttNonrembourser += localprice;\n            this.CousreEncourList.push(data);\n          }\n        } else {\n          if (this.UserConnected.data.role == \"admin\") {\n            this.Course.push(data);\n\n            if (data.statut == \"terminer\" || data.statut == \"arriver\") {\n              //this.ttrembourser += parseInt(data.montant);\n              this.CourseTerminer.push(data);\n            } else {\n              //this.ttNonrembourser += localprice;\n              this.CousreEncourList.push(data);\n            }\n          }\n        }\n      }\n\n      this.TotalCousreterminer = this.CourseTerminer.length;\n      console.log(this.TotalCousreterminer);\n      this.pourcentCourseTerminer = this.TotalCousreterminer * 100 / 10000;\n      this.TotalCourseEcours = this.CousreEncourList.length;\n      this.pourcenCourseEncours = this.TotalCourseEcours * 100 / 10000;\n      this.TotalCourse = this.Course.length;\n      this.pourcentCourse = this.TotalCourse * 100 / 10000;\n      this.changeDetector.detectChanges();\n    });\n  }\n\n}\n\nDashboardComponent.ɵfac = function DashboardComponent_Factory(t) {\n  return new (t || DashboardComponent)(i0.ɵɵdirectiveInject(i1.DatePipe), i0.ɵɵdirectiveInject(i2.UserServiceService), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef));\n};\n\nDashboardComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: DashboardComponent,\n  selectors: [[\"app-dashboard\"]],\n  viewQuery: function DashboardComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.modalComponent = _t.first);\n    }\n  },\n  features: [i0.ɵɵProvidersFeature([DatePipe])],\n  decls: 2,\n  vars: 2,\n  consts: [[\"class\", \"row g-5 g-xl-10 mb-15s mb-xl-2\", 4, \"ngIf\"], [1, \"row\", \"g-5\", \"g-xl-10\", \"mb-15s\", \"mb-xl-2\"], [1, \"col-md-6\", \"col-lg-6\", \"col-xl-6\", \"col-xxl-3\", \"mb-md-5\", \"mb-xl-10\"], [\"cssClass\", \"h-md-50 mb-5 mb-xl-10\", 3, \"AmoutGlobalTransaction\", \"rembourser\", \"NoNrembourser\"], [\"cssClass\", \"h-md-50 mb-5 mb-xl-10w\", \"description\", \"Commandes totales\", \"color\", \"#F1416C\", \"img\", \"./assets/media/patterns/vector-1.png\", 3, \"width\", \"percent\", \"nbrElement\"], [\"cssClass\", \"h-md-50 mb-5 mb-xl-10\", \"description\", \"Commandes termin\\u00E9es\", \"color\", \"#5e6278\", \"img\", \"./assets/media/patterns/vector-2.png\", 3, \"width\", \"percent\", \"nbrElement\"], [\"cssClass\", \"h-md-50 mb-5 mb-xl-10\", \"description\", \"Commande en cours\", \"color\", \"#1E2B77\", \"img\", \"./assets/media/patterns/vector-2.png\", 3, \"width\", \"percent\", \"nbrElement\"], [\"cssClass\", \"h-md-50 mb-5 mb-xl-10w\", \"description\", \"Courses totales\", \"color\", \"#F1416C\", \"img\", \"./assets/media/patterns/vector-1.png\", 3, \"width\", \"percent\", \"nbrElement\"], [\"cssClass\", \"h-md-50 mb-5 mb-xl-10\", \"description\", \"Courses termin\\u00E9es\", \"color\", \"#5e6278\", \"img\", \"./assets/media/patterns/vector-2.png\", 3, \"width\", \"percent\", \"nbrElement\"], [\"cssClass\", \"h-md-50 mb-5 mb-xl-10\", \"description\", \"Courses en cours\", \"color\", \"#1E2B77\", \"img\", \"./assets/media/patterns/vector-2.png\", 3, \"width\", \"percent\", \"nbrElement\"]],\n  template: function DashboardComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, DashboardComponent_div_0_Template, 9, 12, \"div\", 0);\n      i0.ɵɵtemplate(1, DashboardComponent_div_1_Template, 7, 9, \"div\", 0);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.UserConnected.data.role == \"admin\" || ctx.UserConnected.data.role == \"Producteur\" || ctx.UserConnected.data.role == \"Fournisseur\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.UserConnected.data.role == \"admin\" || ctx.UserConnected.data.role == \"Transporteur\");\n    }\n  },\n  dependencies: [i1.NgIf, i3.CardsWidget20Component, i4.CardsWidget17Component],\n  styles: [\"[_nghost-%COMP%] {\\n  width: 100%;\\n}\\n\\n.h-100[_ngcontent-%COMP%] {\\n  height: 100%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRhc2hib2FyZC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLFdBQUE7QUFDRjs7QUFFQTtFQUNFLFlBQUE7QUFDRiIsImZpbGUiOiJkYXNoYm9hcmQuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyI6aG9zdCB7XG4gIHdpZHRoOiAxMDAlO1xufVxuXG4uaC0xMDAge1xuICBoZWlnaHQ6IDEwMCU7XG59XG4iXX0= */\"]\n});","map":{"version":3,"mappings":"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","names":["DatePipe","i0","ctx_r0","DashboardComponent","constructor","datePipe","userService","changeDetector","modalTitle","dismissButtonLabel","closeButtonLabel","openModal","modalComponent","open","ngOnInit","UserConnected","GetUserData","JSON","parse","console","log","GetAllCommand","GetAllCourse","getAllCommandeProduit","subscribe","com","data","localprice","parseInt","prixunitaire","quantite","Idvendeur","id","toString","Rechargement","push","AmoutGlobal","state","ttrembourser","Achatcarte","ttNonrembourser","transactionList","role","TotalAchatcarte","length","pourcentAchatcarte","Totaltransaction","pourcenttransaction","TotalRechargements","pourcentRechargements","detectChanges","transporteuridentifiant","Course","statut","CourseTerminer","CousreEncourList","TotalCousreterminer","pourcentCourseTerminer","TotalCourseEcours","pourcenCourseEncours","TotalCourse","pourcentCourse","selectors","viewQuery","decls","vars","consts","template"],"sourceRoot":"","sources":["/Users/mac/Documents/2PAI_MIGRATION_PROJECT/ogrand_marche_admin/src/app/pages/dashboard/dashboard.component.ts","/Users/mac/Documents/2PAI_MIGRATION_PROJECT/ogrand_marche_admin/src/app/pages/dashboard/dashboard.component.html"],"sourcesContent":["import { ChangeDetectorRef, Component, OnInit, ViewChild } from '@angular/core';\nimport { ModalConfig, ModalComponent } from '../../_metronic/partials';\nimport { DatePipe } from '@angular/common';\nimport { UserServiceService } from 'src/app/services/users/user-service.service';\nimport { GlobalConstants } from 'src/app/common/global-constants';\n\n@Component({\n  selector: 'app-dashboard',\n  templateUrl: './dashboard.component.html',\n  styleUrls: ['./dashboard.component.scss'],\n  providers: [DatePipe]\n})\nexport class DashboardComponent implements OnInit {\n  modalConfig: ModalConfig = {\n    modalTitle: 'Modal title',\n    dismissButtonLabel: 'Submit',\n    closeButtonLabel: 'Cancel',\n  };\n  @ViewChild('modal') private modalComponent: ModalComponent;\n  constructor(private datePipe: DatePipe,private userService:UserServiceService,private changeDetector: ChangeDetectorRef) {\n  }\n\n  async openModal() {\n\n    return await this.modalComponent.open();\n  }\n\n  Distributeur:any[]=[];\n  UserConnected:any;\n  TotalRechargements:any;\n  TotalCourse:any;\n  pourcentRechargements:any;\n  pourcentCourse:any;\n\n  Rechargement:any[]=[];\n  Course:any[]=[];\n\n\n\n  TotalAchatcarte:any;\n  TotalCousreterminer:any;\n  pourcentAchatcarte:any;\n  pourcentCourseTerminer:any;\n\n  Achatcarte:any[]=[];\n  CourseTerminer:any[]=[];\n  AmoutGlobal=0;\n  AmoutGlobalCourse=0;\n  ttrembourser = 0;\n  ttterminer = 0;\n  ttNonrembourser = 0;\n  Totaltransaction:any;\n  TotalCourseEcours:any;\n\n  pourcenttransaction:any;\n  pourcenCourseEncours:any;\n\n  transactionList:any[]=[];\n  CousreEncourList:any[]=[];\n  ngOnInit(): void {\n    //this.GetAllUsers()\n  this.UserConnected = this.userService.GetUserData()\n  this.UserConnected = JSON.parse(this.UserConnected);\n  console.log(\"user =>\",this.UserConnected);\n  this.GetAllCommand(); \n  this.GetAllCourse();\n  }\n\n  GetAllCommand() {\n    this.userService.getAllCommandeProduit().subscribe((com:any)=>{\n     // console.log(com.data);\n      for(var data of com.data){\n        var localprice = parseInt(data.prixunitaire)*parseInt(data.quantite);\n        \n        if(data.Idvendeur==this.UserConnected.data.id.toString()){\n          this.Rechargement.push(data)\n          this.AmoutGlobal+=localprice;\n          if(data.state ==\"Livré\"){\n            this.ttrembourser += localprice;\n            this.Achatcarte.push(data);\n          }else{\n            this.ttNonrembourser += localprice;\n            this.transactionList.push(data);\n          }\n        }else{\n          if(this.UserConnected.data.role == \"admin\"){\n            this.Rechargement.push(data)\n            this.AmoutGlobal+=localprice;\n            if(data.state ==\"Livré\"){\n              this.ttrembourser += localprice;\n              this.Achatcarte.push(data);\n            }else{\n              this.ttNonrembourser += localprice;\n              this.transactionList.push(data);\n            }\n          }\n        }\n      }\n      this.TotalAchatcarte = this.Achatcarte.length;\n      this.pourcentAchatcarte = (this.TotalAchatcarte*100/10000);\n\n      this.Totaltransaction = this.transactionList.length\n      this.pourcenttransaction = (this.Totaltransaction*100/10000);\n\n      this.TotalRechargements = this.Rechargement.length;\n      this.pourcentRechargements = (this.TotalRechargements*100/10000);\n      this.changeDetector.detectChanges();\n    })\n  }\n\n  GetAllCourse() {\n    this.userService.GetAllCourse().subscribe((com:any)=>{\n      console.log(\"ddddd\",com.data);\n      for(var data of com.data){\n       // var localprice = parseInt(data.prixunitaire)*parseInt(data.quantite);\n        \n        if(data.transporteuridentifiant==this.UserConnected.data.id.toString()){\n          this.Course.push(data)\n          if(data.statut ==\"terminer\"||data.statut ==\"arriver\"){\n            //this.ttrembourser += parseInt(data.montant);\n            this.CourseTerminer.push(data);\n          }else{\n            //this.ttNonrembourser += localprice;\n            this.CousreEncourList.push(data);\n          }\n        }else{\n          if(this.UserConnected.data.role == \"admin\"){\n            this.Course.push(data)\n            if(data.statut ==\"terminer\"||data.statut ==\"arriver\"){\n              //this.ttrembourser += parseInt(data.montant);\n              this.CourseTerminer.push(data);\n            }else{\n              //this.ttNonrembourser += localprice;\n              this.CousreEncourList.push(data);\n            }\n          }\n        }\n      }\n      \n       this.TotalCousreterminer = this.CourseTerminer.length;\n       console.log(this.TotalCousreterminer);\n\n       this.pourcentCourseTerminer = (this.TotalCousreterminer*100/10000);\n       this.TotalCourseEcours = this.CousreEncourList.length\n       this.pourcenCourseEncours = (this.TotalCourseEcours*100/10000);\n\n       this.TotalCourse = this.Course.length;\n       this.pourcentCourse = (this.TotalCourse*100/10000);\n       this.changeDetector.detectChanges();\n    })\n  }\n\n  // GetUser(){\n  //   this.UserConnected =  this.userService.UserConnected();\n  //   this.GeTalldistributeur();\n  //   console.log(this.UserConnected)\n  // }\n\n  UserList:any[]=[];\n  // GetAllUsers(){\n  //   this.userService.GetAlluser().subscribe((user:any)=>{\n  //     for(let u of user.data){\n  //       this.UserList.push(u);       \n  //     }\n  //   })\n  // }\n  // getAllrechargements(){\n  //   this.userService.GetAllRechargement().subscribe((recharge:any) => {\n  //     for(const recharges of recharge.data){\n  //       if(this.UserConnected.data.role==\"admin\"){\n  //         this.Rechargement.push(recharges);\n  //       }else if(recharges.distributeur==this.UserConnected.data.distributeur){\n  //         this.Rechargement.push(recharges);\n  //       }\n  //     }\n  //     this.changeDetector.detectChanges();\n  //   },error=>{\n\n  //   },()=>{\n  //     this.TotalRechargements = this.Rechargement.length;\n  //     this.pourcentRechargements = (this.TotalRechargements*100/5000);\n  //     this.changeDetector.detectChanges();\n  //   })\n  // }\n\n  // getAlltransaction(){\n  //   this.userService.GetAllTransaction().subscribe((recharge:any) => {\n  //     //this.MontantTotals+=parseInt(item.montant)\n  //     for(const recharges of recharge.data){\n  //       if(this.UserConnected.data.role==\"admin\"){\n  //         this.transactionList.push(recharges)\n  //         this.AmoutGlobal+=parseInt(recharges.montant)\n  //         if(recharges.state ==\"rembourser\"){\n  //           this.ttrembourser+=parseInt(recharges.montant)\n  //         }\n  //         if(recharges.state ==\"en attente de remboursement\"){\n  //           this.ttNonrembourser+=parseInt(recharges.montant)\n  //         }\n  //         this.changeDetector.detectChanges()\n  //       }else if(recharges.distributeur==this.UserConnected.data.distributeur){\n  //         this.transactionList.push(recharges)\n  //         this.AmoutGlobal+=parseInt(recharges.montant)\n  //         if(recharges.state ==\"rembourser\"){\n  //           this.ttrembourser+=parseInt(recharges.montant)\n  //         }\n  //         if(recharges.state ==\"en attente de remboursement\"){\n  //           this.ttNonrembourser+=parseInt(recharges.montant)\n  //         }\n  //         this.changeDetector.detectChanges()\n  //       }\n  //     }\n  //     this.changeDetector.detectChanges();\n  //   },error=>{\n\n  //   },()=>{\n  //     this.Totaltransaction = this.transactionList.length\n  //     this.pourcenttransaction = (this.Totaltransaction*100/5000);\n  //     this.changeDetector.detectChanges();\n  //     console.log(\"amount global\",this.transactionList)\n  //   })\n  // }\n\n  // getAllAchatcarte(){\n  //   this.userService.GetAllAchat().subscribe((recharge:any) => {\n  //     for(const recharges of recharge.data){\n\n\n  //       if(this.UserConnected.data.role==\"admin\"){\n  //         this.Achatcarte.push(recharges);\n  //       }else if(recharges.distributeur==this.UserConnected.data.distributeur){\n  //         this.Achatcarte.push(recharges);\n  //       }\n  //     }\n  //     this.changeDetector.detectChanges();\n  //   },error=>{\n\n  //   },()=>{\n  //     this.TotalAchatcarte = this.Achatcarte.length;\n  //     this.pourcentAchatcarte = (this.TotalAchatcarte*100/5000);\n  //     this.changeDetector.detectChanges();\n  //   })\n  // }\n}\n","\n\n<!--begin::Row-->\n<div *ngIf=\"UserConnected.data.role =='admin'||UserConnected.data.role =='Producteur'||UserConnected.data.role =='Fournisseur'\" class=\"row g-5 g-xl-10 mb-15s mb-xl-2\">\n  <div class=\"col-md-6 col-lg-6 col-xl-6 col-xxl-3 mb-md-5 mb-xl-10\">\n    <app-cards-widget17 [AmoutGlobalTransaction]=\"AmoutGlobal\" [rembourser]=\"ttrembourser\" [NoNrembourser]=\"ttNonrembourser\"  cssClass=\"h-md-50 mb-5 mb-xl-10\" ></app-cards-widget17>\n  </div>\n  <div class=\"col-md-6 col-lg-6 col-xl-6 col-xxl-3 mb-md-5 mb-xl-10\">\n    <app-cards-widget20  cssClass=\"h-md-50 mb-5 mb-xl-10w\"  width=\"{{pourcentRechargements}}\" percent=\"{{pourcentRechargements}}\"  nbrElement = \"{{TotalRechargements}}\"  description=\"Commandes totales\" color=\"#F1416C\"img=\"./assets/media/patterns/vector-1.png\"></app-cards-widget20>  \n  </div> \n\n  <div class=\"col-md-6 col-lg-6 col-xl-6 col-xxl-3 mb-md-5 mb-xl-10\">\n    <app-cards-widget20 cssClass=\"h-md-50 mb-5 mb-xl-10\" width=\"{{pourcentAchatcarte}}\" \n    percent=\"{{pourcentAchatcarte}}\" nbrElement = \"{{TotalAchatcarte}}\" \n    description=\"Commandes terminées\" color=\"#5e6278\" img=\"./assets/media/patterns/vector-2.png\"></app-cards-widget20>\n  </div>\n\n   <div class=\"col-md-6 col-lg-6 col-xl-6 col-xxl-3 mb-md-5 mb-xl-10\">\n    <app-cards-widget20 cssClass=\"h-md-50 mb-5 mb-xl-10\" width=\"{{pourcenttransaction}}\" \n    percent=\"{{pourcenttransaction}}\" nbrElement = \"{{Totaltransaction}}\" \n    description=\"Commande en cours\" color=\"#1E2B77\" img=\"./assets/media/patterns/vector-2.png\"></app-cards-widget20>\n  </div>\n\n</div>\n\n<div *ngIf=\"UserConnected.data.role =='admin'||UserConnected.data.role =='Transporteur'\" class=\"row g-5 g-xl-10 mb-15s mb-xl-2\">\n\n  <div class=\"col-md-6 col-lg-6 col-xl-6 col-xxl-3 mb-md-5 mb-xl-10\">\n    <app-cards-widget20  cssClass=\"h-md-50 mb-5 mb-xl-10w\"  width=\"{{pourcentCourse}}\" percent=\"{{pourcentCourse}}\"  nbrElement = \"{{TotalCourse}}\"  description=\"Courses totales\" color=\"#F1416C\"img=\"./assets/media/patterns/vector-1.png\"></app-cards-widget20>  \n  </div> \n\n  <div class=\"col-md-6 col-lg-6 col-xl-6 col-xxl-3 mb-md-5 mb-xl-10\">\n    <app-cards-widget20 cssClass=\"h-md-50 mb-5 mb-xl-10\" width=\"{{pourcentCourseTerminer}}\" \n    percent=\"{{pourcentCourseTerminer}}\" nbrElement = \"{{TotalCousreterminer}}\" \n    description=\"Courses terminées\" color=\"#5e6278\" img=\"./assets/media/patterns/vector-2.png\"></app-cards-widget20>\n  </div>\n\n   <div class=\"col-md-6 col-lg-6 col-xl-6 col-xxl-3 mb-md-5 mb-xl-10\">\n    <app-cards-widget20 cssClass=\"h-md-50 mb-5 mb-xl-10\" width=\"{{pourcenCourseEncours}}\" \n    percent=\"{{pourcenCourseEncours}}\" nbrElement = \"{{TotalCourseEcours}}\" \n    description=\"Courses en cours\" color=\"#1E2B77\" img=\"./assets/media/patterns/vector-2.png\"></app-cards-widget20>\n  </div>\n\n</div>\n\n\n\n\n\n <!--<div class=\"row gx-5 gx-xl-10\" style=\"margin-bottom: 0px !important;\">\n  <div class=\"col-md-6 col-lg-6 col-xl-6 col-xxl-3 mb-md-5 mb-xl-10\">\n    <app-cards-widget20 cssClass=\"h-md-50 mb-5 mb-xl-10\" width=\"{{pourcenttransaction}}\" \n    percent=\"{{pourcenttransaction}}\" nbrElement = \"{{Totaltransaction}}\" \n    description=\"Commande en cours\" color=\"#1E2B77\" img=\"./assets/media/patterns/vector-2.png\"></app-cards-widget20>\n  </div>\n </div>-->\n\n\n"]},"metadata":{},"sourceType":"module"}